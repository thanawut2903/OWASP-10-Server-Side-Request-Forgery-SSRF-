# OWASP-10-Server-Side-Request-Forgery-SSRF-

  การโจมตีทางความปลอดภัยในเว็บแอปพลิเคชันที่ผู้โจมตีสามารถบังคับเซิร์ฟเวอร์ของแอปพลิเคชันให้ส่งคำขอ HTTP ไปยังปลายทางที่เลือกได้ ผู้โจมตีสามารถใช้การโจมตีนี้เพื่อ

  1.  เข้าถึงข้อมูลที่ไม่ควรเข้าถึง: เช่น การเข้าถึงข้อมูลภายในของระบบหรือเครือข่ายที่ไม่สามารถเข้าถึงได้จากภายนอก

  2.  สแกนและโจมตีเครือข่ายภายใน: ใช้เซิร์ฟเวอร์ของแอปพลิเคชันเพื่อสแกนเครือข่ายภายในหรือโจมตีระบบอื่นในเครือข่ายเดียวกัน

  3.  Bypass firewalls: ทำให้สามารถส่งคำขอผ่านไฟร์วอลล์ที่ควรจะป้องกันไม่ให้เกิดการเชื่อมต่อจากภายนอก

  4.  นำไปสู่การโจมตีอื่น ๆ: เช่น การโจมตี Remote Code Execution (RCE) หรือการโจมตีแบบ Data Exfiltration

วิธีการทำงานของ SSRF:

  เมื่อแอปพลิเคชันรับ URL จากผู้ใช้และส่งคำขอ HTTP ไปยัง URL นั้นโดยไม่มีการตรวจสอบที่เพียงพอ ผู้โจมตีสามารถเปลี่ยน URL ที่ส่งมาเพื่อบังคับให้เซิร์ฟเวอร์ทำการร้องขอไปยังที่อยู่ที่ผู้โจมตีควบคุมหรือที่อยู่ภายในระบบ

การป้องกัน SSRF:

  1.  การตรวจสอบและกรองอินพุต: ตรวจสอบและกรอง URL ที่รับจากผู้ใช้

  2.  การใช้ Allowlist: อนุญาตเฉพาะ URL หรือโดเมนที่รู้จักและเชื่อถือได้เท่านั้น

  3.  การจำกัดการเชื่อมต่อภายใน: ไม่อนุญาตให้เซิร์ฟเวอร์เชื่อมต่อกับที่อยู่ภายในที่ไม่จำเป็น

  4.  การตรวจสอบและจำกัดการออกไปภายนอก: ตรวจสอบและจำกัดการเชื่อมต่อจากเซิร์ฟเวอร์ออกไปภายนอกอย่างเข้มงวด

Cross-Site Request Forgery (CSRF)

  การโจมตีทางเว็บแอปพลิเคชันที่ผู้โจมตีสามารถบังคับให้ผู้ใช้ที่ได้รับการรับรองแล้วส่งคำขอ HTTP ที่ไม่พึงประสงค์ไปยังแอปพลิเคชันที่เชื่อถือได้ ซึ่งอาจส่งผลให้เกิดการกระทำที่ผู้ใช้ไม่ต้องการในระบบ เช่น การเปลี่ยนรหัสผ่าน การทำธุรกรรม หรือการส่งข้อมูลสำคัญ

วิธีการทำงานของ CSRF:

  1.  ผู้ใช้เข้าสู่ระบบ: ผู้ใช้เข้าสู่ระบบในเว็บแอปพลิเคชัน (เช่น เว็บธนาคาร) และเบราว์เซอร์ของผู้ใช้เก็บข้อมูลการเข้าสู่ระบบ (เช่น คุกกี้เซสชัน) ไว้

  2.  ผู้ใช้เข้าชมเว็บไซต์ที่ไม่ปลอดภัย: ผู้ใช้คลิกที่ลิงก์หรือเข้าชมหน้าเว็บที่ควบคุมโดยผู้โจมตี

  3.  ผู้โจมตีสร้างคำขอปลอม: เว็บไซต์ของผู้โจมตีสร้างคำขอ HTTP ที่จะถูกส่งไปยังแอปพลิเคชันที่เชื่อถือได้ โดยใช้ข้อมูลการเข้าสู่ระบบของผู้ใช้จากเบราว์เซอร์

  4.  แอปพลิเคชันเชื่อถือคำขอ: แอปพลิเคชันที่เชื่อถือได้รับคำขอและดำเนินการตามคำขอเนื่องจากคิดว่ามาจากผู้ใช้ที่ได้รับการรับรอง

การป้องกัน CSRF:

  1.  ใช้ CSRF Token: แอปพลิเคชันควรสร้างโทเค็น CSRF ที่ไม่ซ้ำและสุ่มสำหรับแต่ละเซสชันและรวมไว้ในทุกคำขอที่ส่งไปยังเซิร์ฟเวอร์ จากนั้นตรวจสอบโทเค็นนี้ในเซิร์ฟเวอร์ว่าตรงกับโทเค็นที่เก็บไว้

  2.  ใช้ SameSite Cookie Attribute: กำหนดค่า SameSite attribute สำหรับคุกกี้เป็น Strict หรือ Lax เพื่อป้องกันไม่ให้เบราว์เซอร์ส่งคุกกี้ในคำขอข้ามไซต์

  3.  ยืนยันการกระทำที่สำคัญ: ขอให้ผู้ใช้ยืนยันการกระทำที่สำคัญอีกครั้ง เช่น การป้อนรหัสผ่านหรือใช้การยืนยันสองขั้นตอน (2FA)

  4.  ตรวจสอบ Origin และ Referer Header: ตรวจสอบ Origin และ Referer headers ของคำขอเพื่อให้แน่ใจว่ามาจากไซต์ที่เชื่อถือได้

